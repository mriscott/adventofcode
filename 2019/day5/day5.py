inp="1,9,10,3,2,3,11,0,99,30,40,50"
inp="1,0,0,3,1,1,2,3,1,3,4,3,1,5,0,3,2,6,1,19,2,19,9,23,1,23,5,27,2,6,27,31,1,31,5,35,1,35,5,39,2,39,6,43,2,43,10,47,1,47,6,51,1,51,6,55,2,55,6,59,1,10,59,63,1,5,63,67,2,10,67,71,1,6,71,75,1,5,75,79,1,10,79,83,2,83,10,87,1,87,9,91,1,91,10,95,2,6,95,99,1,5,99,103,1,103,13,107,1,107,10,111,2,9,111,115,1,115,6,119,2,13,119,123,1,123,6,127,1,5,127,131,2,6,131,135,2,6,135,139,1,139,5,143,1,143,10,147,1,147,2,151,1,151,13,0,99,2,0,14,0"
inp="1002,4,3,4,33"
inp="1101,100,-1,4,0"

inp="3,225,1,225,6,6,1100,1,238,225,104,0,101,67,166,224,1001,224,-110,224,4,224,102,8,223,223,1001,224,4,224,1,224,223,223,2,62,66,224,101,-406,224,224,4,224,102,8,223,223,101,3,224,224,1,224,223,223,1101,76,51,225,1101,51,29,225,1102,57,14,225,1102,64,48,224,1001,224,-3072,224,4,224,102,8,223,223,1001,224,1,224,1,224,223,223,1001,217,90,224,1001,224,-101,224,4,224,1002,223,8,223,1001,224,2,224,1,223,224,223,1101,57,55,224,1001,224,-112,224,4,224,102,8,223,223,1001,224,7,224,1,223,224,223,1102,5,62,225,1102,49,68,225,102,40,140,224,101,-2720,224,224,4,224,1002,223,8,223,1001,224,4,224,1,223,224,223,1101,92,43,225,1101,93,21,225,1002,170,31,224,101,-651,224,224,4,224,102,8,223,223,101,4,224,224,1,223,224,223,1,136,57,224,1001,224,-138,224,4,224,102,8,223,223,101,2,224,224,1,223,224,223,1102,11,85,225,4,223,99,0,0,0,677,0,0,0,0,0,0,0,0,0,0,0,1105,0,99999,1105,227,247,1105,1,99999,1005,227,99999,1005,0,256,1105,1,99999,1106,227,99999,1106,0,265,1105,1,99999,1006,0,99999,1006,227,274,1105,1,99999,1105,1,280,1105,1,99999,1,225,225,225,1101,294,0,0,105,1,0,1105,1,99999,1106,0,300,1105,1,99999,1,225,225,225,1101,314,0,0,106,0,0,1105,1,99999,1107,226,226,224,102,2,223,223,1006,224,329,1001,223,1,223,1007,226,677,224,1002,223,2,223,1005,224,344,101,1,223,223,108,677,677,224,1002,223,2,223,1006,224,359,101,1,223,223,1008,226,226,224,1002,223,2,223,1005,224,374,1001,223,1,223,108,677,226,224,1002,223,2,223,1006,224,389,101,1,223,223,7,226,226,224,102,2,223,223,1006,224,404,101,1,223,223,7,677,226,224,1002,223,2,223,1005,224,419,101,1,223,223,107,226,226,224,102,2,223,223,1006,224,434,1001,223,1,223,1008,677,677,224,1002,223,2,223,1005,224,449,101,1,223,223,108,226,226,224,102,2,223,223,1005,224,464,1001,223,1,223,1108,226,677,224,1002,223,2,223,1005,224,479,1001,223,1,223,8,677,226,224,102,2,223,223,1006,224,494,1001,223,1,223,1108,677,677,224,102,2,223,223,1006,224,509,1001,223,1,223,1007,226,226,224,1002,223,2,223,1005,224,524,1001,223,1,223,7,226,677,224,1002,223,2,223,1005,224,539,1001,223,1,223,8,677,677,224,102,2,223,223,1005,224,554,1001,223,1,223,107,226,677,224,1002,223,2,223,1006,224,569,101,1,223,223,1107,226,677,224,102,2,223,223,1005,224,584,1001,223,1,223,1108,677,226,224,102,2,223,223,1006,224,599,1001,223,1,223,1008,677,226,224,102,2,223,223,1006,224,614,101,1,223,223,107,677,677,224,102,2,223,223,1006,224,629,1001,223,1,223,1107,677,226,224,1002,223,2,223,1005,224,644,101,1,223,223,8,226,677,224,102,2,223,223,1005,224,659,1001,223,1,223,1007,677,677,224,102,2,223,223,1005,224,674,1001,223,1,223,4,223,99,226"

l=inp.split(",")


i=0
o=0
errorcode=0
thevalue=1
o=l[i]
while (o!="99" and o!=99):
  if (errorcode!=0):
    print "Last test was an error"
    exit
  print ("Operation:",o)
  word=list(o);
  o=word[len(word)-1];
  print ("Opcode:",o)
  i=i+1
  x=int(l[i])
  paramx=0
  if (len(word)>2 and word[len(word)-3]=="1"):
    paramx=1
  i=i+1
  if (o=="1" or o =="2"):
    y=int(l[i])
    paramy=0
    if (len(word)>3 and word[len(word)-4]=="1"):
      paramy=1
    i=i+1
    z=int(l[i])
    paramz=0
    if (len(word)>4 and word[len(word)-5]=="1"):
      paramz=1
    i=i+1


  # TODO - add value mode and other opcodes
  if (paramx==1):
    valx=x
  else:
    valx=l[x]
  print ("X:",valx,paramx)
  if (o=="1" or o=="2"):
    if (paramy==1):
      valy=y
    else:
      valy=l[y]
    print ("Y:",valy,paramy)
    # z can't be in value mode as its an output
    if (paramz == 1):
      print "Output parameter mode is value"
      exit
  if(o=="1"):
    l[z]=str(int(valx)+int(valy))
    print (valx,"+",valy,"->",z)
  if (o=="2"):
    l[z]=str(int(valx)*int(valy))
    print (valx,"*",valy,"->",z)
  if (o=="3"):
    if (paramx==1):
      print "Output param mode error"
      exit
    l[x]=str(thevalue)
    print (thevalue,"->",x)

  if (o=="4"):
    thevalue=valx
    print("Output: ", thevalue)
    if(thevalue!=0  and thevalue!="0"):
       errorcode=1
  o=l[i]


print( "Diagnostic code",thevalue)

